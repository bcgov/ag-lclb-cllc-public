<div class="form-wrapper" style="position: relative">
    <div [ngBusy]="busy"></div>

    <div>
        <div [formGroup]="form" style=" position: relative">
            <!-- Title -->
            <h1 class="ngtest-page-title">Covid Temporary Extension Application</h1>
        </div>

        <div [formGroup]="form">
            <!-- Preamble -->
            <section class="ngtest-preamble-content">
                <p>
                    Licensees may apply for a temporary extension of their licensed areas for a limited period, subject
                    to any restrictions within the Liquor Control and Licensing Act, Regulations, branch policies and
                    /or original terms and conditions of licensing. Approval of this temporary change request permits
                    the licensee to operate at the capacity on the face of their current licence plus the capacity of
                    the extension area. If in doubt, consult with licensing staff at LCRB
                </p>
            </section>


            <h3 class="blue-header">LICENCE INFORMATION</h3>
            <section class="padded-section content-bottom">

                <app-field label="Licence Number" [valid]="isValidOrNotTouched('licenceNumber')"
                    errorMessage="Licence Number is a required field">
                    <input class="form-control" style="width: 500px;" type="text" formControlName="licenceNumber">
                </app-field>

                <app-field label="Licence Type" [valid]="isValidOrNotTouched('licenceType')"
                    errorMessage="Licence Type is a required field">
                    <input class="form-control" style="width: 500px;" type="text" formControlName="licenceType">
                </app-field>

                <app-field label="Licensee Name (as shown on licence)" [valid]="isValidOrNotTouched('nameOfApplicant')"
                    errorMessage="Licensee Name is a required field">
                    <input class="form-control" style="width: 500px;" type="text" formControlName="nameOfApplicant">
                </app-field>

                <app-field label="Establishment Name (as shown on licence)"
                    [valid]="isValidOrNotTouched('establishmentName')"
                    errorMessage="Establishment Name is a required field">
                    <input class="form-control" style="width: 500px;" type="text" formControlName="establishmentName">
                </app-field>


                <app-field [valid]="true">
                    <label class="pr-5 m-0">Establishment address</label>

                    <div class="row">
                        <app-field class="col-md-4" [valid]="isValidOrNotTouched('establishmentAddressStreet')"
                            errorMessage="Establishment  Address Street is a required field">
                            <input class="form-control" style="width: 500px;" type="text" placeholder="Street"
                                formControlName="establishmentAddressStreet">
                        </app-field>

                        <app-field class="col-md-4" [valid]="isValidOrNotTouched('establishmentAddressCity')"
                            errorMessage="Establishment  Address City is a required field">
                            <input class="form-control" style="width: 500px;" type="text" placeholder="City"
                                formControlName="establishmentAddressCity">
                        </app-field>

                        <app-field class="col-md-4" [valid]="isValidOrNotTouched('establishmentAddressPostalCode')"
                            errorMessage="This is required. The postal code should be in one of the following formats: X1X1X1 (no spaces)">
                            <input class="form-control" style="width: 500px;" type="text" placeholder="Postal Code"
                                formControlName="establishmentAddressPostalCode">
                        </app-field>
                    </div>
                </app-field>

                <app-field label="Contact First Name" [valid]="isValidOrNotTouched('contactFirstName')"
                    errorMessage="Contact First Name is a required field">
                    <input class="form-control" style="width: 500px;" type="text" formControlName="contactFirstName">
                </app-field>

                <app-field label="Contact Last Name" [valid]="isValidOrNotTouched('contactLastName')"
                    errorMessage="Contact Last Name is a required field">
                    <input class="form-control" style="width: 500px;" type="text" formControlName="contactLastName">
                </app-field>

                <app-field label="Title/Position" [valid]="isValidOrNotTouched('contactRole')"
                    errorMessage="Title/Position is a required field">
                    <input class="form-control" style="width: 500px;" type="text" formControlName="contactRole">
                </app-field>

                <app-field label="Business Tel" [valid]="isValidOrNotTouched('businessTelephone')"
                    errorMessage="Business Tel is a required field">
                    <input class="form-control" style="width: 500px;" type="text" formControlName="businessTelephone">
                </app-field>

                <app-field label="Business Email" [valid]="isValidOrNotTouched('businessEmail')"
                    errorMessage="Business Email is a required field">
                    <input class="form-control" style="width: 500px;" type="text" formControlName="businessEmail">
                </app-field>

                <app-field [valid]="true">
                    <section style="display: flex; align-items: center;">
                        <label class="pr-5 m-0">Mailing address</label>
                        <input type="checkbox" formControlName="sameAddresses">
                        <div class="pl-2">
                            Same as above
                        </div>
                    </section>
                    <div class="row">
                        <app-field class="col-md-4" [valid]="isValidOrNotTouched('establishmentMailingAddressStreet')"
                            errorMessage="Establishment Mailing Address Street is a required field">
                            <input class="form-control" style="width: 500px;" type="text" placeholder="Street"
                                formControlName="establishmentMailingAddressStreet">
                        </app-field>

                        <app-field class="col-md-4" [valid]="isValidOrNotTouched('establishmentMailingAddressCity')"
                            errorMessage="Establishment Mailing Address City is a required field">
                            <input class="form-control" style="width: 500px;" type="text" placeholder="City"
                                formControlName="establishmentMailingAddressCity">
                        </app-field>

                        <app-field class="col-md-4"
                            [valid]="isValidOrNotTouched('establishmentMailingAddressPostalCode')"
                            errorMessage="This is required. The postal code should be in one of the following formats: X1X1X1 (no spaces)">
                            <input class="form-control" style="width: 500px;" type="text" placeholder="Postal Code"
                                formControlName="establishmentMailingAddressPostalCode">
                        </app-field>
                    </div>
                </app-field>
            </section>

            <h3 class="blue-header ngtest-declarations">
                TEMPORARY EXTENSION OF LICENSED AREA
            </h3>
            <div class="padded-section content-bottom">
                <p>
                    Please provide the following information and documents:
                </p>

                <app-field [valid]="!showValidationMessages || form.get('currentTotalCapicityIncluded').valid"
                    errorMessage="This check is required" [showChevrons]="false">
                    <section style="display: flex">
                        <input type="checkbox" formControlName="currentTotalCapicityIncluded">
                        <div style="padding-left: 10px;">
                            Current total capacity, including patios (as shown on licence);
                        </div>
                    </section>
                </app-field>

                <app-field [valid]="!showValidationMessages || form.get('areasToBeExtendedIncluded').valid"
                    errorMessage="This check is required" [showChevrons]="false">
                    <section style="display: flex">
                        <input type="checkbox" formControlName="areasToBeExtendedIncluded">
                        <div style="padding-left: 10px;">
                            Identify the area(s) to be extended;
                        </div>
                    </section>
                </app-field>

                <app-field [valid]="!showValidationMessages || form.get('floorPlanIncluded').valid"
                    errorMessage="This check is required" [showChevrons]="false">
                    <section style="display: flex">
                        <input type="checkbox" formControlName="floorPlanIncluded">
                        <div style="padding-left: 10px;">
                            <div>Floor plan of the extended area(s) showing how perimeter is defined, dimensions and its
                                physical relationship to existing licensed areas:</div>

                            <ul>
                                <li>Floor plan must have occupant load of the extended area marked/stamped on the plans
                                    by provincial fire or building authority (or designate)
                                    where the extension is indoors or within a permanent structure.</li>
                                <li>Provide proposed person capacity of extended area(s) if extension is outside; and
                                </li>
                            </ul>
                        </div>
                    </section>
                </app-field>

                <app-field [valid]="!showValidationMessages || form.get('writtenApprovalIncluded').valid"
                    errorMessage="This check is required" [showChevrons]="false">
                    <section style="display: flex">
                        <input type="checkbox" formControlName="writtenApprovalIncluded">
                        <div style="padding-left: 10px;">
                            Where the proposed area is not on property owned or controlled by the licensee, provide
                            written approval for such use from the property owner.
                        </div>
                    </section>
                </app-field>


                <section style="text-align: center; color: lightblue">
                  <app-delayed-file-uploader documentType="Floorplan"
                                     [enableFileDeletion]="true"
                                     [useDocumentTypeForName]="true" fileTypes="FILE MUST BE IN PDF, JPG OR PNG FORMAT." [multipleFiles]="true"
                                     entityName="application" [extensions]="['jpg', 'jpeg', 'png', 'pdf']"
                                     (numberOfUploadedFiles)="uploadedFloorplanDocuments = $event" 
                                     [uploadHeader]="'TO UPLOAD FLOOR PLAN, DRAG FILES HERE OR'">
                  </app-delayed-file-uploader>
                </section>
            </div>

            <h3 class="blue-header ngtest-declarations">
                ADD, CHANGE OR REMOVE A LICENSEE REPRESENTATIVE NOTIFICATION FORM (OPTIONAL)
            </h3>
            <div class="padded-section content-bottom">
                <p>
                    In some cases, a licensee may wish to authorize a specific individual to take certain actions on the
                    licensee's behalf and to legally bind the licensee in respect of those matters. For example:
                </p>
                <ul>
                    <li>
                        A licensee that is a company may wish to authorize an employee who is not a company director or
                        officer.
                    </li>
                    <li>
                        A partner in a partnership may wish to authorize a manager at the establishment who is not a
                        partner.
                    </li>
                    <li>
                        A society may wish to authorize an individual who is not a director or senior manager of the
                        society.
                    </li>
                    <li>
                        A licensee who is an individual person may wish to authorize someone else to make decisions and
                        take actions in respect of specific liquor control and licensing matters.
                    </li>
                </ul>
                <p>
                    Download the form <a href="">here</a>.
                </p>

                <section style="text-align: center; color: lightblue">
                  <app-delayed-file-uploader documentType="LicenseeRepresentativeNotficationForm"
                                             [enableFileDeletion]="true"
                                             [useDocumentTypeForName]="true" fileTypes="FILE MUST BE IN PDF, JPG OR PNG FORMAT." [multipleFiles]="true"
                                             entityName="application" [extensions]="['jpg', 'jpeg', 'png', 'pdf']"
                                             (numberOfUploadedFiles)="uploadedLicenseeRepresentativeNotficationFormDocuments = $event" 
                                             [uploadHeader]="'TO UPLOAD LICENSEE REPRESENTATIVE NOTIFICATION FORM, DRAG FILES HERE OR'">
                  </app-delayed-file-uploader>
                </section>
            </div>

            <h3 class="blue-header ngtest-declarations">
                LOCAL GOVERNMENT/FIRST NATION COMMENTS
            </h3>
            <div class="padded-section content-bottom">
                <p>
                    This application process requires comment from your local government/First Nation. Please download
                    and take the completed application form and all required documents to their local government/First
                    Nation and request that the local government/First Nation complete.
                </p>
                <app-field [valid]="!showValidationMessages || form.get('receivedLGPermission').valid"
                    errorMessage="Please affirm that all of the information provided for this application is true and complete."
                    [showChevrons]="false">
                    <section style="display: flex">
                        <input type="checkbox" formControlName="receivedLGPermission">
                        <span class="error-states">*</span>
                        <div style="padding-left: 10px;">
                            I have received permission from my Local Government.
                        </div>
                    </section>
                </app-field>
            </div>

            <h3 class="blue-header ngtest-declarations">
                DECLARATIONS
            </h3>
            <div class="padded-section content-bottom">
                <app-field [valid]="!showValidationMessages || form.get('signatureAgreement').valid"
                    errorMessage="Please affirm that all of the information provided for this application is true and complete."
                    [showChevrons]="false">
                    <section style="display: flex">
                        <input type="checkbox" formControlName="signatureAgreement">
                        <span class="error-states">*</span>
                        <div style="padding-left: 10px;">
                            As the licensee or authorized signatory of the licensee, I understand and affirm that all of
                            the information provided is true and complete.
                        </div>
                    </section>
                </app-field>
            </div>

            <section class="error mt-3 p-3" *ngIf="!form.valid && form.touched">
                <div *ngIf="!validationMessages?.length">
                    <i class="fas fa-exclamation-triangle" style="margin-right: 5px;"></i>
                    <span>Some required fields have not been completed</span>
                  </div>
                <div *ngIf="validationMessages?.length">
                    <i class="fas fa-exclamation-triangle" style="margin-right: 5px;"></i>
                    <span>The following fields are not valid:</span>
                  </div>
                <ul *ngFor="let message of validationMessages">
                    <li class="app-cancel">
                        {{message}} 
                    </li>
                </ul>
            </section>

            <section style="position: relative; margin-top: 20px;">
                <button class="btn btn-primary" (click)="submitApplication()">
                    <i class="fa fa-save" style="color: #fff;"></i>
                    SUBMIT APPLICATION</button>
                <span style="float: right; color: #1a5a96; padding-top: 10px;">
                    <a routerLink="/">
                        <i class="fas fa-trash-alt" style="color: #1a5a96;"></i>
                        Cancel Application
                    </a>
                </span>
                <div [ngBusy]="busy"></div>
            </section>
        </div>
    </div>
</div>
