<div>
  <div [ngBusy]="busy"></div>
  <h3 class="blue-header" style="margin-bottom: 0; margin-top: 0;">APPLICATIONS</h3>
  <section style="border: 1px solid #ccc; padding: 10px;  border-bottom: 4px solid #FFCC00;">
    <section>
      <div *ngIf="submittedApplications < 300  && !marketerExists">
        <p>
          Use the list below to find the application type you are looking for:
        </p>

        <section>
          <h3>CANNABIS LICENCE APPLICATIONS</h3>
          <div *ngIf="!(nonMarketerExists || marketerExists)"><p>
            <i>*You cannot apply for both cannabis licences, you can apply for one or other.</i>
          </p></div>

          <table class="start-application">
            <!-- <tr>
              <th colspan=2>LICENCE</th>
              <th></th>
            </tr> -->
            <tr *ngIf="!(marketerExists)">
              <td style="background-color: #E1E8F2; padding: 10px; width: 15px;">
                <img class="icon" src="assets/Cannabis-store-icon-blue-40px.png" alt="">
              </td>
              <td style="width:700px;">
                <h3>Cannabis Retail Store Licence</h3>
                <p>The cannabis retail store licence allows licensees to sell non-medical cannabis and accessories.</p>
                <P>(A separate application must be submitted for each proposed store)</P>
                <a href="https://justice.gov.bc.ca/cannabislicensing/policy-document/cannabis-retail-licence"
                  target="_blank" rel="noopener noreferrer">Learn more about this licence</a>
              </td>
              <td style="text-align: center;">
                <button class="btn btn-primary" (click)="startNewLicenceApplication()" id="startCRS">START
                  APPLICATION</button>
              </td>
            </tr>
            <tr *ngIf="!(nonMarketerExists || marketerExists)">
              <td style="background-color: #E1E8F2; padding: 10px; width: 15px;">

                <img class="icon" src="assets/Cannabis-marketing-icon-blue-40px.png" alt="">
              </td>
              <td style="width:700px;">
                <h3>Cannabis Marketing Licence</h3>
                <p>The Cannabis Marketing Licence allows licensees to promote non-medical cannabis to licensed cannabis retail stores and the adult public.</p>
                <a href="https://justice.gov.bc.ca/cannabislicensing/policy-document/cannabis-marketing-licence">Learn
                  more about this licence</a>
              </td>
              <td style="text-align: center;">
                <button class="btn btn-primary" (click)="startNewMarketerApplication()" id="startMarketing">START
                  APPLICATION</button>
              </td>
            </tr>
          </table>
        </section>
        <hr>
        <section>
          <h3>LIQUOR LICENCE APPLICATIONS</h3>
          <table class="start-application">
            <tr>
              <td style="background-color: #E1E8F2; padding: 10px; width: 15px;">
                <img class="icon" src="assets/Catering-icon-blue-40px.png" alt="">
              </td>
              <td style="width:700px;">
                <h3>Catering Licence</h3>
                <p>Catering licences are for catering businesses that provide a full range of food and beverage services
                  to their clients. Licensed caterers can sell liquor and maintain a liquor inventory. </p>
                <a href="https://www2.gov.bc.ca/gov/content/employment-business/business/liquor-regulation-licensing/liquor-licences-permits/applying-for-a-liquor-licence-or-permit/catering-liquor-licence"
                  target="_blank">Learn
                  more about this licence</a>
              </td>
              <td style='text-align: center;'>
                <button *ngIf="liquorOne" class="btn btn-primary" (click)="startNewCateringApplication()"
                  id="startCatering">START
                  APPLICATION</button>
                  <button *ngIf="!liquorOne" class="btn btn-primary"
                  id="startCatering" disabled>COMING SOON</button>  
                
              </td>
            </tr>
            <tr>
              <td style="background-color: #E1E8F2; padding: 10px; width: 15px;">
                <img class="icon" src="assets/Wine-store-icon-blue-40px.png" alt="">
              </td>
              <td style="width:700px;">
                <h3>Wine Retail Store Licence</h3>
                <p>Wine Stores licences allow businesses to sell wine to retail customers. This include stores associated with a particular winery or group of wineries, independent wine stores, Vintners Quality Alliance (VQA) wine stores and tourist wine stores. They operate as a separate retail store and are not located at a winery. </p>
                
                <a href="https://www2.gov.bc.ca/gov/content/employment-business/business/liquor-regulation-licensing/liquor-licences-permits/applying-for-a-liquor-licence-or-permit/wine-store-liquor-licence"
                  target="_blank">Learn
                  more about this licence</a>
              </td>
              <td style="text-align: center;">
                <i>New wine store applications <br>are closed at this time.</i>
              </td>
            </tr>

            <!--tr>
              <!-- Apply for a Rural Agency Store Licence
              <td style="background-color: #E1E8F2; padding: 10px; width: 15px;">
                <img class="icon" src="assets/Wine-store-icon-blue-40px.png" alt="">
              </td>
              <td style="width:700px;">
                <h3>Rural Agency Store Licence</h3>
                <p>Existing Rural Agency Stores may now apply for their official LCRB Liquor Licence. Note, you will need an existing Rural Agency Store registration number to complete the application. </p>
                
                <a href="https://www2.gov.bc.ca/gov/content/employment-business/business/liquor-regulation-licensing/liquor-licences-permits/applying-for-a-liquor-licence-or-permit/wine-store-liquor-licence"
                  target="_blank">Learn
                  more about this licence</a>
              </td>
              <td style="text-align: center;">
                <button *ngIf="liquorOne" class="btn btn-primary" (click)="startNewRASApplication()"
                id="startCatering">START
                APPLICATION</button>
              </td>
            </tr-->

          </table>
        </section>
      </div>

      <mat-tab-group [selectedIndex]="0">
        <mat-tab label="In Progress Applications" id="inProgressApplications">
          <section *ngIf="inProgressApplications?.length > 0">
            <label>Please note:</label> <br>
            <p>Due to the high volume of applications, we ask that you limit questions about the status of your
              application
              as much as possible. Answering fewer questions provides us more capacity to process applications.
            </p>
            <p>We will contact you regarding your application as soon as we have an update to communicate, have
              information
              that you will need to know, or are requesting additional information from you.
            </p>
            <p>Thank you for your patience.</p>
          </section>
          <p *ngIf="inProgressApplications?.length == 0 ">
            You do not have any In Progress Applications.
          </p>
          <table *ngIf="inProgressApplications?.length > 0" class="eq-table">
            <tr>
              <th colspan=2>Application</th>
              <!-- <th style="width: 95px">Last Updated</th> -->
              <th style="width: 235px">Status</th>
              <th>Actions</th>
            </tr>
            <tr *ngFor="let item of inProgressApplications; let i = index;" style="border: 1px solid #ccc; ">
              <td style="background-color: #E1E8F2; padding: 10px; width: 15px;"><span>{{i+1}}</span></td>
              <td style="background-color: #F1F4FA; padding: 10px; padding-bottom: 15px;">
                <span style="font-weight: 600">{{item.establishmentName}}</span> <br>
                <span>{{item.portallabel}}</span> <br>
                <span>Application No: </span> <i>{{item.jobNumber}}</i> <br>
                <span>Reference #: {{item.name}} </span> <span></span> <br>
              </td>
              <!--
                <td style="padding: 10px; width: 110px;">
                  {{item.modifiedon | date:'mediumDate'}}
                </td>
              -->
              <td style="background-color: #E1E8F2; padding: 10px;">
                <div style="text-transform: uppercase; font-weight: 600;">{{item.applicationStatus}}</div>
                <p *ngIf="item.applicationStatus === 'Not Submitted'">
                  This application has not yet been submitted.
                </p>
                <p *ngIf="item.applicationStatus === 'Relocation Initiated'">
                  This relocation application has not yet been submitted
                </p>
                <p *ngIf="item.applicationStatus === 'Transfer Initiated'">
                  This transfer application has not yet been submitted
                </p>
                <p *ngIf="item.applicationStatus === 'Application Under Review'">
                  Your application has been received and is being reviewed by the LCRB.
                </p>
                <p *ngIf="item.applicationStatus === 'Transfer Application Under Review'">
                  Your transfer application has been received and is being reviewed by the LCRB.
                </p>
                <p *ngIf="item.applicationStatus === 'Relocation Application Under Review'">
                  Your relocation application has been received and is being reviewed by the LCRB.
                </p>

                <p *ngIf="item.applicationStatus === 'Application Incomplete'">
                  Your application is incomplete. You must provide additional information for it to be processed.
                </p>
                <p *ngIf="item.applicationStatus === 'Pending External Review'">
                  Your application has been sent for local government, financial integrity, and security screening
                  reviews.
                </p>
                <p *ngIf="item.applicationStatus === 'Approved In Principle'">
                  Your application has been approved in principle. An inspector will be contacting you to organize a
                  final inspection.
                </p>
              </td>
              <td style="background-color: #E1E8F2; padding: 10px;">
                <div *ngIf="item.applicationStatus === 'Not Submitted'">
                  <a appRemoveIfFeatureOff="LicenseeChanges"
                     *ngIf="item.applicationTypeName !== ApplicationTypeNames.CRSRenewal && item.applicationTypeName !== ApplicationTypeNames.Catering && item.applicationTypeName !== ApplicationTypeNames.LiquorRenewal"
                     routerLink="/multi-step-application/{{item.id}}" id="completeApp{{item.id}}">
                    <i class="fas fa-pencil-alt" style="color: #1a5a96; margin-right: 10px;"></i>
                    <span>Complete Application</span>
                  </a>
                  <a appRemoveIfFeatureOff="LicenseeChanges"
                     *ngIf="item.applicationTypeName !== ApplicationTypeNames.CRSRenewal && item.applicationTypeName === ApplicationTypeNames.Catering"
                     [routerLink]="['/multi-step-application/' + item.id, {useDynamicFormMode:'true'}]" id="completeApp{{item.id}}">
                    <i class="fas fa-pencil-alt" style="color: #1a5a96; margin-right: 10px;"></i>
                    <span>Complete Application</span>
                  </a>
                  <a appRemoveIfFeatureOn="LicenseeChanges"
                     *ngIf="item.applicationTypeName !== ApplicationTypeNames.CRSRenewal"
                     routerLink="/account-profile/{{item.id}}" id="completeApp{{item.id}}">
                    <i class="fas fa-pencil-alt" style="color: #1a5a96; margin-right: 10px;"></i>
                    <span>Complete Application</span>
                  </a>
                  <a *ngIf="item.applicationTypeName === ApplicationTypeNames.CRSRenewal || item.applicationTypeName === ApplicationTypeNames.LiquorRenewal"
                     routerLink="/renew-licence/{{getRenewalType(item.applicationTypeName)}}/{{item.id}}">
                    <i class="fas fa-pencil-alt" style="color: #1a5a96; margin-right: 10px;"></i>
                    <span>Complete Renewal</span>
                  </a>
                </div>
                <div *ngIf="item.applicationStatus === 'Relocation Initiated'">
                  <a [routerLink]="['/account-profile/' + item.id, { mode: CHANGE_OF_LOCATION_MODE }]">
                    <i class="fas fa-pencil-alt" style="color: #1a5a96; margin-right: 10px;"></i>
                    <span>Complete Relocation</span>
                  </a>
                </div>
                <div *ngIf="item.applicationStatus === 'Transfer Initiated'">
                  <a [routerLink]="['/account-profile/' + item.id, { mode: TRANSFER_LICENCE_MODE }]">
                    <i class="fas fa-pencil-alt" style="color: #1a5a96; margin-right: 10px;"></i>
                    <span>Complete Transfer</span>
                  </a>
                </div>
                <div *ngIf="item.applicationStatus === 'Licensee Change Initiated'">
                  <a [routerLink]="['/licensee-changes/' + item.id]">
                    <i class="fas fa-pencil-alt" style="color: #1a5a96; margin-right: 10px;"></i>
                    <span>Complete Licensee Change</span>
                  </a>
                </div>
                <div *ngIf="item.applicationStatus === 'Not Submitted'" style="margin-top: 5px;"
                  (click)="cancelApplication(item.id, item.establishmentName, item.name)">
                  <a href="javascript: void(0)">
                    <i class="fas fa-trash-alt" style="color: #1a5a96; margin-right: 10px;"></i>
                    <span>Cancel Application</span>
                  </a>
                </div>
                <div *ngIf="item.applicationStatus === 'Relocation Initiated'" style="margin-top: 5px;"
                  (click)="cancelApplication(item.id, item.establishmentName, item.name)">
                  <a href="javascript: void(0)">
                    <i class="fas fa-trash-alt" style="color: #1a5a96; margin-right: 10px;"></i>
                    <span>Cancel Relocation</span>
                  </a>
                </div>
                <div *ngIf="item.applicationStatus === 'Transfer Initiated'" style="margin-top: 5px;"
                  (click)="cancelApplication(item.id, item.establishmentName, item.name)">
                  <a href="javascript: void(0)">
                    <i class="fas fa-trash-alt" style="color: #1a5a96; margin-right: 10px;"></i>
                    <span>Cancel Transfer</span>
                  </a>
                </div>
                <div *ngIf="item.applicationStatus === 'Licensee Change Initiated'" style="margin-top: 5px;"
                  (click)="cancelApplication(item.id, item.establishmentName, item.name)">
                  <a href="javascript: void(0)">
                    <i class="fas fa-trash-alt" style="color: #1a5a96; margin-right: 10px;"></i>
                    <span>Cancel Licensee Change</span>
                  </a>
                </div>
                <div
                  *ngIf="['Relocation Application Under Review','Transfer Application Under Review', 'Application Under Review', 'Pending External Review'].indexOf(item.applicationStatus) !== -1">
                  <a style="margin-top: 5px;" href="javascript:void(0);" (click)="uploadMoreFiles(item)">
                    <i class="fas fa-plus" style="color: #1a5a96; margin-right: 10px;"></i>
                    <span>Add Supporting Documents</span>
                  </a>
                </div>
            </tr>
          </table>
          <p></p>
        </mat-tab>
      </mat-tab-group>
    </section>

  </section>
</div>
